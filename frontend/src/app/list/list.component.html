<div class="app-container">
  <div class="header">
    <h1 class="pozpro">Pozent Projects</h1>
  </div>
  <div class="content">
    <div class="left-panel">
      <h2 class="h2">Projects</h2>
      <div class="plusminus">
        <button class="plus" (click)="openAddlistDialog()">+</button>
        <button class="minus" (click)="toggleDeleteMode()">-</button>
      </div>
      <mat-list>
        <mat-list-item class="prolist" *ngFor="let project of projects">
          <button mat-button (click)="handleProjectClick(project)">
            {{ project.projectlist }}
          </button>
          <button
            mat-icon-button
            *ngIf="deleteMode"
            class="delete"
            (click)="openDeleteDialog(project)"
          >
            <mat-icon class="delete">delete</mat-icon>
          </button>
        </mat-list-item>
      </mat-list>
    </div>
    <div class="right-panel">
      <div *ngIf="selectedProject">
        <div class="fixed-header">
          <h1 class="pro-head">{{ selectedProject.projectlist }}</h1>
          <button
            mat-raised-button
            color="warn"
            (click)="toggleFileDeleteMode()"
          >
            Delete
          </button>
        </div>
        <div class="fixed-upload-options">
          <div class="upload-container">
            <div class="upload-section">
              <h3 class="h3-vid">Videos</h3>
              <input
                type="file"
                class="input-vid"
                (change)="onFileSelect($event, 'videos')"
              />
            </div>
            <div class="upload-section">
              <h3 class="h3-doc">Documents</h3>
              <input
                type="file"
                class="input-doc"
                (change)="onFileSelect($event, 'docs')"
              />
            </div>
            <div class="upload-section">
              <h3 class="h3-misc">Miscellaneous</h3>
              <input
                type="file"
                class="input-misc"
                (change)="onFileSelect($event, 'misc')"
              />
            </div>
            <button
              class="upload-button"
              mat-raised-button
              color="primary"
              (click)="onUploadAll()"
            >
              <mat-icon>cloud_upload</mat-icon>
            </button>
          </div>
        </div>
        <div class="file-lists">
          <div class="file-list-section">
            <h3 class="h3-vidlist">Video List</h3>
            <div class="file-item" *ngFor="let file of projectFiles.videos">
              <video
                [src]="file.file_url"
                class="video-thumbnail"
                controls
              ></video>
              <button
                mat-icon-button
                *ngIf="deleteMode"
                (click)="confirmDeleteFile(file)"
                class="delete-button"
              >
                <mat-icon>delete</mat-icon>
              </button>
              <p class="file-name">{{ file.file_name | slice : 0 : 10 }}...</p>
            </div>
          </div>
          <div class="file-list-section">
            <h3 class="h3-doclist">Document List</h3>
            <div class="file-item" *ngFor="let file of projectFiles.docs">
              <a [href]="file.file_url" download="{{ file.file_name }}">
                <img
                  src="assets/doc-icon.png"
                  alt="{{ file.file_name }}"
                  class="thumbnail"
                />
              </a>
              <button
                mat-icon-button
                *ngIf="deleteMode"
                (click)="confirmDeleteFile(file)"
                class="delete-button"
              >
                <mat-icon>delete</mat-icon>
              </button>
              <p class="file-name">{{ file.file_name | slice : 0 : 10 }}...</p>
            </div>
          </div>
          <div class="file-list-section">
            <h3 class="h3-otherfile">Other Files</h3>
            <div class="file-item" *ngFor="let file of projectFiles.misc">
              <a [href]="file.file_url" download="{{ file.file_name }}">
                <img
                  src="assets/file-icon.png"
                  alt="{{ file.file_name }}"
                  class="thumbnail"
                />
              </a>
              <button
                mat-icon-button
                *ngIf="deleteMode"
                (click)="confirmDeleteFile(file)"
                class="delete-button"
              >
                <mat-icon>delete</mat-icon>
              </button>
              <p class="file-name">{{ file.file_name | slice : 0 : 10 }}...</p>
            </div>
          </div>
        </div>
      </div>
      <div *ngIf="!selectedProject" class="centered-message">
        <p>Select a project to view details and upload files.</p>
      </div>
    </div>
  </div>
  <div class="footer">
    <p class="copyright">&copy; 2024 Project Portfolio</p>
  </div>
</div>

<ng-template #deleteDialog>
  <h1 mat-dialog-title>Confirm Deletion</h1>
  <div mat-dialog-content>Are you sure you want to delete this project?</div>
  <div mat-dialog-actions>
    <button mat-button (click)="onCancelDelete()">Cancel</button>
    <button mat-button (click)="onConfirmDelete()" cdkFocusInitial>
      Delete
    </button>
  </div>
</ng-template>

<ng-template #confirmationDialog let-data>
  <h1 mat-dialog-title>Confirm Deletion</h1>
  <div mat-dialog-content>
    Are you sure you want to delete {{ data.file_name }}?
  </div>
  <div mat-dialog-actions>
    <!-- <button mat-button (click)="dialogRef.close()">Cancel</button> -->
    <button mat-button (click)="onCancelDelete()">Cancel</button>
    <button mat-button (click)="onConfirmDeleteFile(data)">Delete</button>
  </div>
</ng-template>
